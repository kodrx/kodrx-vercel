<!-- 1) BotÃ³n de prueba -->
<button id="btnRecetaDemo" type="button">Crear receta DEMO</button>

<!-- 2) Script (SDK 12.2.1) -->
<script type="module">
  import { auth, db } from "/firebase-init.js";
  import { addDoc, collection, serverTimestamp } 
    from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

  document.getElementById("btnRecetaDemo")?.addEventListener("click", async () => {
    const uid = auth.currentUser?.uid;
    if (!uid) { alert("Inicia sesiÃ³n como mÃ©dico"); return; }

    try {
      const ref = await addDoc(collection(db, "recetas"), {
        medicoUid: uid,                    // ðŸ‘ˆ clave para que aparezca en historial
        createdAt: serverTimestamp(),      // ðŸ‘ˆ orden correcto
        pacienteNombre: "Juan PÃ©rez (DEMO)",
        diagnostico: "Gastritis aguda (DEMO)",
        medicamentos: [
          { nombre: "Omeprazol 20 mg", dosis: "1 c/24 h", duracion: "14 dÃ­as" },
          { nombre: "Almagato", dosis: "10 ml c/8 h", duracion: "7 dÃ­as" }
        ]
      });
      alert(`Receta creada: ${ref.id}\nAbre el Historial para verla.`);
    } catch (e) {
      alert("Error al crear receta DEMO: " + (e?.message || e));
    }
  });
</script>
